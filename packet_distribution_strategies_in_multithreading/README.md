# 멀티스레드에서의 패킷 분배 전략 

## 전제
- 네트워크 처리는 비동기 IO
- 패킷 처리(클라이언트 요청)는 워커스레드
- 패킷 데이터는 세션 별로 할당 되어 있다
- 프로그래밍 언어는 C#
   
   
## PacketQueue, 패키 처리 완료 통보 
  
  
  
## PacketList, 패키 처리 완료 통보  
- 미리 capacity(D)를 설정한다
- 현재 사용 중인 패킷 데이터 개수(C)
- 현재 사용 인덱스(A)가 가리키는 패킷 데이터를 사용한다
    - (C)가 (D)와 같으면 빈 패킷 데이터가 없다는 뜻이다
- 현재 사용량 크기(B)
- 패킷 처리 스레드로 보내면 (B)에 `+1` 킨다.
- 통보쪽에서는 알리면 (B)에 `-1` 시킨다.

- 낙관적처리: 통보 없이(빈 데이터가 있는지 조사하지 않고) 로테이션 
  
  
## 링버퍼, 패키 처리 완료 통보    

- 통보쪽에서는 패킷 크기만 알려주면 Int64 타입의 변수에 누적시킨다.  
  
- 낙관적처리: 통보 없이 로테이션  
  