# KCP PROTOCOL SPECIFICATION
[출처](https://github.com/skywind3000/kcp/blob/master/protocol.txt )

# 패킷(일명 세그먼트) 구조
KCP에는 단 한 가지 종류의 세그먼트만 있다.
동일한 구조로 인코딩되고 동일한 헤더를 공유한다.

KCP 패킷(일명 세그먼트) 구조는 다음과 같다:
<pre>
0               4   5   6       8 (BYTE)
+---------------+---+---+-------+
|     conv      |cmd|frg|  wnd  |
+---------------+---+---+-------+   8
|     ts        |     sn        |
+---------------+---------------+  16
|     una       |     len       |
+---------------+---------------+  24
|                               |
|        DATA (optional)        |
|                               |
+-------------------------------+
</pre>

## conv: 대화 ID(32비트 정수)

대화 ID는 각 연결을 식별하는 데 사용되며, 연결 수명 동안 변경되지 않는다.
변경되지 않는 각 연결을 식별하는데 사용된다.

이는 32비트 정수로 표현되며, 이는 KCP 제어 블록(일명: 구조체 ikcpcb 또는 kcp 객체)이 생성되는 순간 주어지는 32비트 정수로 표시된다. 전송되는 각 패킷은 처음 4바이트에 대화(conv) ID를 포함하며, 원격 엔드포인트에서 전송되는 원격 엔드포인트의 패킷은 다른 대화 ID를 가진 경우 대화 ID가 다르면 수락되지 않는다.

이 값은 임의의 숫자가 될 수 있지만, 실제로는 양쪽 연결 사이에는 연결 사이의 양쪽 모두는 맵이나 배열과 같은 컨테이너에 저장한다. 인덱스는 컨테이너에서 한 개의 인덱스를 키로 사용한다.

따라서 대화 ID의 상위 16비트는 발신자 인덱스로 사용할 수 있고 하위 16비트는 수신자의 인덱스로 사용할 수 있다. KCP는 핸드셰이크를 처리하지 않으며, 양쪽의 인덱스는 연결이 설정된 후에 결정하고 교환할 수 있다.

원격 패킷을 수신하고 수락하면 로컬 인덱스를 추출할 수 있다. 로컬 인덱스를 추출할 수 있으며, 이를 담당하는 kcp 객체는 맵이나 배열에서 찾을 수 있다.

- cmd: command
- frg: fragment count
- wnd: window size
- ts: timestamp
- sn: serial number
- una: un-acknowledged serial number
